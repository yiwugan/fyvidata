#include <ansi.h>
#include <weapon.h>
inherit FORK;
void create()
{
        set_name( COR "¶©×÷µÄ" NOR, ({ "order" }) );
        set_weight(3000);
        if( clonep() )
                set_default_object(__FILE__);
        else {
                set("unit", "°Ñ");
                set("timestamp","STAMP");
                set("value", 10000);
                set("rigidity",300);
                set("level",0);
                set("can_inset",1);
                set("material", "steel");
        }
        ::init_fork(30);
}
string query_save_file()
{
	return sprintf(DATA_DIR "questitem/%s", query("timestamp"));
}
int save()
{
        string file;
        string equipped;
        int result;
        if( stringp(file = this_object()->query_save_file()) ) {
                equipped = (string)query("equipped");
                delete("equipped");
                assure_file(file+ __SAVE_EXTENSION__);
                result = save_object(file,1);
                set("equipped",equipped);
                return result;
        }
        return 0;
}
int restore()
{
        string file;
        if( stringp(file = this_object()->query_save_file()) )
        if(restore_object(file))
        {
                set_weight(query("weight"));
                return 1;
        }
        return 0;
}
